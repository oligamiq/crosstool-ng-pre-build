name: install crosstool-ng

description: |
  This action installs crosstool-ng on the runner.

inputs:
  version:
    description: 'The version of the toolchain to install.'
    required: true

  target:
    description: 'The toolchain to install.'
    required: true

runs:
  using: composite
  steps:
    - name: upload toolchain
      shell: bash
      env:
        GH_TOKEN: ${{ github.token }}
      run: |
        git switch ${{ inputs.version }}
        git config --local user.email "41898282+github-actions[bot]@users.noreply.github.com"
        git config --local user.name "github-actions[bot]"

        rm -rf "./${{ inputs.target }}"
        cp -r "/x-tools/${{ inputs.target }}" "./${{ inputs.target }}"

        git add -A
        git commit -m "Add toolchains for ${{ inputs.target }} ${{ inputs.version }}"

    - name: Push changes
      shell: bash
        uses: ad-m/github-push-action@master
        with:
          github_token: ${{ github.token }}
          branch: ${{ github.event.inputs.version }}
